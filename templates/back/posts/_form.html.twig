{{ form_start(form) }}

    {% if post.imgPost is empty %}
            <img src={{'https://res.cloudinary.com/dsn2zwbis/image/upload/portfolio/Accueil.webp'}} alt="imgHeader" > 
    {% else %}
            <img src={{'https://res.cloudinary.com/dsn2zwbis/image/upload/portfolio/' ~ post.imgPost ~ '.webp'}} alt="imgHeader" >
    {% endif %}
            <!-- Loader -->
            <div id="loader" class="fixed z-10 inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50 hidden">
                <div class="bg-white rounded-lg shadow-lg w-96 p-6 text-center">
                    <!-- Spinner -->
                    <div class="flex justify-center mb-4">
                        <svg class="animate-spin h-12 w-12 text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 1116 0A8 8 0 014 12z"></path>
                        </svg>
                    </div>
                    <!-- Message -->
                    <p class="text-lg font-semibold text-gray-800">Attendre le résultat de ChatGPT...</p>
                </div>
            </div>
            <!-- Modal -->
            <div id="gptModal" class="fixed z-10 inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50 hidden">
                <div class="bg-white rounded-lg shadow-lg w-96 p-6">
                    <h2 class="text-xl font-bold mb-4">Validation du texte</h2>
                    <div id="gptMessage" class="text-gray-700 mb-6"></div>
                    <div class="flex justify-end space-x-4">
                        <button type="button" id="acceptBtn" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Valider</button>
                        <button type="button" id="cancelBtn" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600">Annuler</button>
                    </div>
                </div>
            </div>

            <button type="button" data-controller="gpt" data-action="gpt#handleChatGptPosts" class="button " >
                Créer le posts avec ChatGPT
            </button>
            

            <ul class="pb-4">
                <li class="flex text-lg">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6z" />
                    </svg> Catégories :
                </li>
                <li class="flex text-sm border-gray-600 border-b">
                    {{ form_widget(form.category) }}
                </li>
                <li class="flex text-lg pt-4">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6z" />
                    </svg> Sous-catégories :
                </li>
                <li class=" text-sm border-gray-600 border-b ">
                    {{ form_widget(form.subcategory) }}
                </li>
                
            </ul>
            
            {{ form_row(form.imgPost) }}
            <div class="add__altImg hidden">
                {{ form_row(form.altImg) }}
            </div>
            <p class="button__altImg pb-4">Changez le descriptif de l'image</p>
            {{ form_row(form.video )}}
            {{ form_row(form.heading) }}
            {{ form_row(form.title) }}
            {{ form_row(form.metaDescription) }}
            {{ form_row(form.contents) }}
              <div class="pt-4" >
                <ul 
                    id="paragraph-container"
                    class="paragraph"
                    data-index="{{ form.paragraphPosts|length > 0 ? form.paragraphPosts|last.vars.name + 1 : 0 }}"
                    data-prototype="{{ form_widget(form.paragraphPosts.vars.prototype)|e('html_attr') }}"
                >   
                    {% for paragraph in form.paragraphPosts %}
                        <li class="h-auto ">
                            {{ form_row(paragraph.subtitle) }}
                            {{ form_row(paragraph.chatGptButton, {'attr': 
                                { 
                                    'class': 'button ',
                                    'data-subtitle':  paragraph.subtitle.vars.value,
                                    'data-id': paragraph.vars.id,
                                    'data-paragraph-id': paragraph.vars.value.id
                                }}) }}
                            <div id="{{paragraph.vars.id}}_loader" style="display: none;">Chargement...</div>

                            {{ form_widget(paragraph) }}
                        </li>
                    {% endfor %}
                </ul>
                <div class="flex text-lg border-gray-600 border-b button_paragraph ">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12" />
                      </svg>              
                      Ajouter un paragraphe
                </div>
            </div>

            <ul 
                class="list"
                data-index="{{ form.listPosts|length > 0 ? form.listPosts|last.vars.name + 0 : 0 }}"
                data-prototype="{{ form_widget(form.listPosts.vars.prototype)|e('html_attr') }}"
            >   
                {% for tag in form.listPosts %}
                    <li>
                        {{ form_row(tag) }}
                    </li>

                {% endfor %}
            </ul>

            <div class="flex text-lg border-gray-600 border-b button__list pt-4">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zM3.75 12h.007v.008H3.75V12zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm-.375 5.25h.007v.008H3.75v-.008zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
                  </svg>
                  Ajouter une liste
                </div>  


            <div class="add__link hidden">
                {{ form_label(form.links) }}
                {{ form_widget(form.links) }}
                {{ form_label(form.textLinks) }}
                {{ form_widget(form.textLinks) }}
            </div>
            <div class="button__link flex text-lg border-gray-600 border-b pt-4">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" />
                  </svg>
                  Ajouter un lien
            </div>


            <div class="add__github hidden">
                {{ form_label(form.github) }}
                {{ form_widget(form.github) }}
            </div>
            <div class="add__website hidden">
                {{ form_label(form.website) }}
                {{ form_widget(form.website) }}
            </div>
                {{ form_row(form.relatedPosts) }}

            <button type="submit" class="button is-primary is-fullwidth">{{ button_label|default('Sauvegarder') }}</button>
            
{{ form_end(form) }}

{% block javascripts %}
    <!-- <script src="https://cdn.tiny.cloud/1/7u35jqplbqwmajtzpxrhtp68lx5t04fxq9qtnrtwxf03z0pw/tinymce/7/tinymce.min.js" referrerpolicy="origin"></script> -->
    <script src={{asset('js/posts.js')}}></script>
{% endblock %}